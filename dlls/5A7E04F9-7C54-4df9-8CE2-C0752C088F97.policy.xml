<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (c) Microsoft Corporation.  All rights reserved.
-->
<CeSecurityPolicyFile Description="Default DCOM security policy" Vendor="Microsoft" RequiredOSVersion="7.00" FileVersion="7.4.9876" xmlns="urn:Microsoft.PlatformBuilder/CeSecurityPolicy">

    <Rule Description="Policy for DCOM API ready events" ResourceIri="policy:/KERNEL/EVENT/SYSTEM/DCOMApiSetReady" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
        <Authorize>
            <Match AccountId="$(SID_UDEVICE_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
        </Authorize>
        <Stop>
            <Match AccountId="$(EVERYONE_GROUP_NAME)"></Match>
        </Stop>
    </Rule>

    <Rule Description="Policy for DCOM Task Scheduler events" ResourceIri="policy:/KERNEL/EVENT/SYSTEM/DCOMWakeUpEvent/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
        <Authorize>
            <Match AccountId="$(SID_UDEVICE_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
        </Authorize>
        <Stop>
            <Match AccountId="$(EVERYONE_GROUP_NAME)"></Match>
        </Stop>
    </Rule>

<!-- dllhost: DLL Host security policy -->
    
<!--Begin Generated accounts and routing/authz rules for S-1-5-112-0-0X10-0X00000011 -->
<Macro Id="DLLHOST_EXE_SID" Value="S-1-5-112-0-0X10-0X00000011" />
<Account Id="$(DLLHOST_EXE_SID)" FriendlyName="DLLHost.exe" Description="Autogenerated chamber for DLLHost.exe" Type="User">
<MemberOfGroup GroupAccountId="$(ELEVATED_RIGHTS_CHAMBER_GROUP_NAME)" />
</Account>
<!--Begin Generated routing/authz rules for DLLHost.exe -->
<Rule Description="Route DLLHost.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/DLLHOST.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(DLLHOST_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize DLLHost.exe be loadable to $(DLLHOST_EXE_SID) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/DLLHOST.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(DLLHOST_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for DLLHost.exe -->
<!--End Generated accounts and routing/authz rules for S-1-5-112-0-0X10-0X00000011 -->


<!-- lpcd: Policy to allow access to the NT4 LPC driver. -->
    <Rule Description="Authorization for NT4 LPC Driver" ResourceIri="$(DEVICEMANAGER_DEVICE)/LPC/1" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
        <Authorize>
            <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="ALL_ACCESS"></Match>
        </Authorize>
    </Rule>

<!-- Allow SID_UDEVICE_STANDARD to advertise the dcomssd service guid -->
    <Rule Description="Allow SID_UDEVICE_STANDARD to advertise the dcomssd service guid" ResourceIri="$(GLOBAL_RESOURCES)/DEVICE_NOTIFICATIONS/70809323-B988-4114-83A4-7D0BA480C96B" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
        <Authorize>
            <Match AccountId="$(SID_UDEVICE_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
        </Authorize>
    </Rule>

</CeSecurityPolicyFile>

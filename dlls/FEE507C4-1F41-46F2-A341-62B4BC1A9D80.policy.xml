<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (c) Microsoft Corporation.  All rights reserved.
-->
<CeSecurityPolicyFile Description="netcfv37: NETCF security policy;" Vendor="Microsoft" RequiredOSVersion="7.00" FileVersion="7.4.9876" xmlns="urn:Microsoft.PlatformBuilder/CeSecurityPolicy">  
  <!-- netcfv37: NETCF security policy -->
  
<!--Begin Generated accounts and routing/authz rules for S-1-5-112-0-0X20-0X0000000E -->
<Macro Id="CFLAUNCHER_EXE_SID" Value="S-1-5-112-0-0X20-0X0000000E" />
<Account Id="$(CFLAUNCHER_EXE_SID)" FriendlyName="CFLauncher.exe" Description="Autogenerated chamber for CFLauncher.exe" Type="User">
<MemberOfGroup GroupAccountId="$(STANDARD_RIGHTS_CHAMBER_GROUP_NAME)" />
</Account>
<!--Begin Generated routing/authz rules for CFLauncher.exe -->
<Rule Description="Route CFLauncher.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/CFLAUNCHER.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(CFLAUNCHER_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize CFLauncher.exe be loadable to $(CFLAUNCHER_EXE_SID) and $(STANDARD_RIGHTS_CHAMBER_GROUP_NAME) chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/CFLAUNCHER.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CFLAUNCHER_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
<Match AccountId="$(STANDARD_RIGHTS_CHAMBER_GROUP_NAME)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for CFLauncher.exe -->
<!--End Generated accounts and routing/authz rules for S-1-5-112-0-0X20-0X0000000E -->



  <Rule Description="Ensure the NET CF Installer registry keys can be written only from Elevated Rights and above. This will ensure NET CF GAC is secure. Modifying the registry entries under this hive by unprivileged access can lead to denial of service by deleting already gac'ed binary." ResourceIri="$(HKLM)/SOFTWARE/MICROSOFT/.NETCOMPACTFRAMEWORK/INSTALLER/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
    <Authorize>
      <Match AccountId="$(ELEVATED_RIGHTS_RESOURCE_GROUP_NAME)" AuthorizationIds="KEY_ALL_ACCESS"></Match>
      <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="KEY_READ"></Match>
    </Authorize>
    <Stop>
      <Match AccountId="$(EVERYONE_GROUP_NAME)"></Match>
    </Stop>
  </Rule>

  <!-- Policy rules enable everyone capability -->
  <!-- Read registr value /REGISTRY/HKLM/SECURITY/.NETCOMPACTFRAMEWORK/RUNTIMEDATASHARING -->
  <Rule Description="MSCOREE3_7!PALConfig_InitModule" ResourceIri="$(HKLM)/SECURITY/.NETCOMPACTFRAMEWORK/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
      <Authorize>
          <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="KEY_READ"></Match>
      </Authorize>
  </Rule>

  <!-- Policy rules for ETW logging -->
  <Rule Description="Allow everyone to read retail logging control keys" ResourceIri="$(HKLM)/SOFTWARE/Microsoft/.NETCompactFramework/Diagnostics/Logging/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
      <Authorize>
          <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="KEY_READ"></Match>
      </Authorize>
  </Rule>

  <Rule Description="Allow everyone to read perf logging control keys" ResourceIri="$(HKLM)/Security/.NETCompactFramework/Diagnostics/Logging/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
      <Authorize>
          <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="KEY_READ"></Match>
      </Authorize>
  </Rule>

  <Rule Description="Allow everyone to log to the NetCF client channel" ResourceIri="$(GLOBAL_RESOURCES)/EVENTLOG_CHANNEL/Microsoft-DotNetCFClient-Channel" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
    <Authorize>
      <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="GENERIC_WRITE"></Match>
    </Authorize>
  </Rule>

  <Rule Description="Allow everyone to log to the NetCF Server channel" ResourceIri="$(GLOBAL_RESOURCES)/EVENTLOG_CHANNEL/Microsoft-DotNetCFServer-Channel" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
    <Authorize>
      <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="GENERIC_WRITE"></Match>
    </Authorize>
  </Rule>

</CeSecurityPolicyFile>

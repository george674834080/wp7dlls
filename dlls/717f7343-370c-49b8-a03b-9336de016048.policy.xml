<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (c) Microsoft Corporation.  All rights reserved.
-->
<CeSecurityPolicyFile Description="Specifies policies for the Mobile Entertainment apps" Vendor="Microsoft" RequiredOSVersion="7.00" FileVersion="7.4.9876" xmlns="urn:Microsoft.PlatformBuilder/CeSecurityPolicy">
  <!-- SID_MEUX_STANDARD = S-1-5-112-0-0X20-0X00000022 -->
  <Macro Id="SID_MEUX_STANDARD" Description="Media applications SID" Value="S-1-5-112-0-0X20-0X00000022"></Macro>
  <Macro Id="MEDIAAPPS_USER_FRIENDLY_NAME" Description="Media apps" Value="LOC_ACCOUNT_FRIENDLY_NAME_MEDIAAPPS_USER"></Macro>
  <Macro Id="SID_ZMF_CHAMBER" Description="ZMF Chamber SID" Value="S-1-5-112-0-0X20-0X00000022"></Macro>
  <Account Id="$(SID_MEUX_STANDARD)" FriendlyName="$(MEDIAAPPS_USER_FRIENDLY_NAME)" Action="CreateNew" Description="Media apps" Type="User">
    <MemberOfGroup Action="Add" GroupAccountId="$(STANDARD_RIGHTS_CHAMBER_GROUP_NAME)"></MemberOfGroup>
  </Account>
  <!-- Capabilities for Yamanote applications -->
  
<!--Begin generating capability accounts and authorization rules for ID_CAP_RINGTONE_ADD -->
<Macro Id="CAPMACRO_ID_CAP_RINGTONE_ADD" Value="S-1-5-112-0-0X70-0X49445F4341505F52494E47544F4E455F414444" />
<Account Id="$(CAPMACRO_ID_CAP_RINGTONE_ADD)" FriendlyName="ID_CAP_RINGTONE_ADD:Allows ringtone-marketplace applications to read/write into the Ringtones directory" Description="Autogenerated group for capability ID_CAP_RINGTONE_ADD" Type="Group">
<MemberOfGroup GroupAccountId="$(PUBLIC_CAPABILITIES_GROUP_NAME)" />
</Account>
<Rule Description="Authorization rule for capability ID_CAP_RINGTONE_ADD" ResourceIri="$(FILESYS_PRIMARY_ROOT)/MY%20DOCUMENTS/MY%20RINGTONES/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_RINGTONE_ADD)" AuthorizationIds="FILE_ALL_ACCESS" />
</Authorize>
</Rule>
<!--End generating capability accounts and authorization rules for ID_CAP_RINGTONE_ADD -->

<!--Begin generating capability accounts and authorization rules for ID_CAP_MEDIALIB -->
<Macro Id="CAPMACRO_ID_CAP_MEDIALIB" Value="S-1-5-112-0-0X70-0X49445F4341505F4D454449414C4942" />
<Account Id="$(CAPMACRO_ID_CAP_MEDIALIB)" FriendlyName="ID_CAP_MEDIALIB:Access to the media library - read, play-back, etc." Description="Autogenerated group for capability ID_CAP_MEDIALIB" Type="Group">
<MemberOfGroup GroupAccountId="$(PUBLIC_CAPABILITIES_GROUP_NAME)" />
</Account>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="$(GLOBAL_RESOURCES)/ZMF_API_COMMON/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="ALL_ACCESS" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="$(GLOBAL_RESOURCES)/ZMF_API_MEDIA_LIB/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="ALL_ACCESS" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="$(FILESYS_PRIMARY_ROOT)/MY%20DOCUMENTS/ZUNE/CONTENT/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="FILE_GENERIC_READ" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="$(FILESYS_PRIMARY_ROOT)/MOUNTED%20VOLUME/ZUNE/CONTENT/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="FILE_GENERIC_READ" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="$(FILESYS_PRIMARY_ROOT)/STORAGE%20CARD/ZUNE/CONTENT/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="FILE_GENERIC_READ" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="/FILESYS/SECONDARY/HDPROFILE/ZUNE/CONTENT/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="FILE_GENERIC_READ" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="$(DEVICEMANAGER_DEVICE)/ZMF/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="ALL_ACCESS" />
</Authorize>
</Rule>
<Rule Description="Authorization rule for capability ID_CAP_MEDIALIB" ResourceIri="policy:/RESOURCES/$(SID_ZMF_CHAMBER)/DEVICEMANAGER/ACTIVATEDEVICE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CAPMACRO_ID_CAP_MEDIALIB)" AuthorizationIds="ALL_ACCESS" />
</Authorize>
</Rule>
<!--End generating capability accounts and authorization rules for ID_CAP_MEDIALIB -->

  <!-- Rules -->
  <Rule Description="Allow GamesUX to access the IOCTLs for auth services (GameCPL)" ResourceIri="$(DEVICEMANAGER_BUS)/SERVICES/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
    <Authorize>
      <Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
  </Rule>
  <Rule Description="Allow GamesUX to manage the IDCRL service (GameCPL)" ResourceIri="$(DEVICEMANAGER_DEVICE)/WLI/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
    <Authorize>
      <Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
  </Rule>
  <Rule Description="Grant PhotoEntCapture access to SHDehydrateProcess() for opt-in hibernation" ResourceIri="$(GLOBAL_RESOURCES)/SHELL/SHTriggerShellAction" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
    <Authorize>
      <Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
  </Rule>
  <Rule Description="Allow PhotoEntCapture access to the Proximity sensor" ResourceIri="$(DEVICEMANAGER_DEVICE)/PRX/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
    <Authorize>
      <Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
  </Rule>
  <Rule Description="Allow GamesUx access to the accelerometersensor" ResourceIri="$(DEVICEMANAGER_DEVICE)/ACC/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
    <Authorize>
      <Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
  </Rule>
  <Rule Description="ZMedia service" ResourceIri="$(DEVICEMANAGER_DEVICE)/ZME/0" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
    <Authorize>
      <Match AccountId="$(EVERYONE_GROUP_NAME)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
  </Rule>
  <Rule Description="Policy for Microsoft.MediaApps.PhotosTaskMutex mutex" ResourceIri="policy:/KERNEL/MUTEX/GLOBAL/Microsoft.MediaApps.PhotosTaskMutex" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
    <Authorize>
      <Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="ALL_ACCESS"></Match>
    </Authorize>
    <Stop>
      <Match AccountId="$(EVERYONE_GROUP_NAME)"></Match>
    </Stop>
  </Rule>
  
<!--Begin Generated accounts and routing/authz rules for $(SID_MEUX_STANDARD) -->

<!--Begin Generated routing/authz rules for MeUx.exe -->
<Rule Description="Route MeUx.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/MEUX.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize MeUx.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/MEUX.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for MeUx.exe -->

<!--Begin Generated routing/authz rules for GamesUx.exe -->
<Rule Description="Route GamesUx.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/GAMESUX.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize GamesUx.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/GAMESUX.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for GamesUx.exe -->

<!--Begin Generated routing/authz rules for zmftasklaunch.exe -->
<Rule Description="Route zmftasklaunch.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/ZMFTASKLAUNCH.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize zmftasklaunch.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/ZMFTASKLAUNCH.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for zmftasklaunch.exe -->

<!--Begin Generated routing/authz rules for PhotoEnt.exe -->
<Rule Description="Route PhotoEnt.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/PHOTOENT.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize PhotoEnt.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/PHOTOENT.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for PhotoEnt.exe -->

<!--Begin Generated routing/authz rules for PhotoEntCapture.exe -->
<Rule Description="Route PhotoEntCapture.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/PHOTOENTCAPTURE.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize PhotoEntCapture.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/PHOTOENTCAPTURE.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for PhotoEntCapture.exe -->

<!--Begin Generated routing/authz rules for MediaGrovel.exe -->
<Rule Description="Route MediaGrovel.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/MEDIAGROVEL.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize MediaGrovel.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/MEDIAGROVEL.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for MediaGrovel.exe -->

<!--Begin Generated routing/authz rules for RmObsoleteCache.exe -->
<Rule Description="Route RmObsoleteCache.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/RMOBSOLETECACHE.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize RmObsoleteCache.exe be loadable to $(SID_MEUX_STANDARD) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/RMOBSOLETECACHE.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SID_MEUX_STANDARD)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for RmObsoleteCache.exe -->
<!--End Generated accounts and routing/authz rules for $(SID_MEUX_STANDARD) -->

  
<!--Begin Generated accounts and routing/authz rules for $(SYSTEM_USER_NAME) -->

<!--Begin Generated routing/authz rules for 717f7343-370c-49b8-a03b-9336de016048.exe -->
<Rule Description="Route 717f7343-370c-49b8-a03b-9336de016048.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/717F7343-370C-49B8-A03B-9336DE016048.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(SYSTEM_USER_NAME)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize 717f7343-370c-49b8-a03b-9336de016048.exe be loadable to $(SYSTEM_USER_NAME) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/717F7343-370C-49B8-A03B-9336DE016048.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(SYSTEM_USER_NAME)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for 717f7343-370c-49b8-a03b-9336de016048.exe -->
<!--End Generated accounts and routing/authz rules for $(SYSTEM_USER_NAME) -->

</CeSecurityPolicyFile>

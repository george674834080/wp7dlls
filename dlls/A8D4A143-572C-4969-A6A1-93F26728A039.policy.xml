<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (c) Microsoft Corporation.  All rights reserved.
-->
<CeSecurityPolicyFile Description="ShellApps security policies" Vendor="Microsoft" RequiredOSVersion="7.00" FileVersion="7.4.9876" xmlns="urn:Microsoft.PlatformBuilder/CeSecurityPolicy">

    
<!--Begin Generated accounts and routing/authz rules for S-1-5-112-0-0X10-0X0000000A -->
<Macro Id="OOBE_EXE_SID" Value="S-1-5-112-0-0X10-0X0000000A" />
<Account Id="$(OOBE_EXE_SID)" FriendlyName="oobe.exe" Description="Autogenerated chamber for oobe.exe" Type="User">
<MemberOfGroup GroupAccountId="$(ELEVATED_RIGHTS_CHAMBER_GROUP_NAME)" />
</Account>
<!--Begin Generated routing/authz rules for oobe.exe -->
<Rule Description="Route oobe.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/OOBE.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(OOBE_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize oobe.exe be loadable to $(OOBE_EXE_SID) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/OOBE.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(OOBE_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for oobe.exe -->

<!--Begin Generated routing/authz rules for wlidsetup.exe -->
<Rule Description="Route wlidsetup.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/WLIDSETUP.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(OOBE_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize wlidsetup.exe be loadable to $(OOBE_EXE_SID) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/WLIDSETUP.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(OOBE_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for wlidsetup.exe -->
<!--End Generated accounts and routing/authz rules for S-1-5-112-0-0X10-0X0000000A -->

    
    
<!--Begin Generated accounts and routing/authz rules for S-1-5-112-0-0X20-0X0000002D -->
<Macro Id="ALARMS_EXE_SID" Value="S-1-5-112-0-0X20-0X0000002D" />
<Account Id="$(ALARMS_EXE_SID)" FriendlyName="alarms.exe" Description="Autogenerated chamber for alarms.exe" Type="User">
<MemberOfGroup GroupAccountId="$(STANDARD_RIGHTS_CHAMBER_GROUP_NAME)" />
</Account>
<!--Begin Generated routing/authz rules for alarms.exe -->
<Rule Description="Route alarms.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/ALARMS.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(ALARMS_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize alarms.exe be loadable to $(ALARMS_EXE_SID) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/ALARMS.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(ALARMS_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for alarms.exe -->
<!--End Generated accounts and routing/authz rules for S-1-5-112-0-0X20-0X0000002D -->


    
<!--Begin Generated accounts and routing/authz rules for S-1-5-112-0-0X20-0X0000000A -->
<Macro Id="CLOCKNOT_EXE_SID" Value="S-1-5-112-0-0X20-0X0000000A" />
<Account Id="$(CLOCKNOT_EXE_SID)" FriendlyName="clocknot.exe" Description="Autogenerated chamber for clocknot.exe" Type="User">
<MemberOfGroup GroupAccountId="$(STANDARD_RIGHTS_CHAMBER_GROUP_NAME)" />
</Account>
<!--Begin Generated routing/authz rules for clocknot.exe -->
<Rule Description="Route clocknot.exe" ResourceIri="$(LOADERVERIFIER_ROUTE_BY_NAME)/PRIMARY/WINDOWS/CLOCKNOT.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_LOW">
<Authorize>
<Match AccountId="$(CLOCKNOT_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE" />
</Authorize>
</Rule>
<Rule Description="Authorize clocknot.exe be loadable to $(CLOCKNOT_EXE_SID) and  chambers" ResourceIri="$(LOADERVERIFIER_EXE_AUTHZ_INROM_ROOT)/WINDOWS/CLOCKNOT.EXE" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_STANDARD">
<Authorize>
<Match AccountId="$(CLOCKNOT_EXE_SID)" AuthorizationIds="LV_ACCESS_EXECUTE,LV_ACCESS_LOAD" />
</Authorize>
</Rule>
<!--End Generated routing/authz rules for clocknot.exe -->
<!--End Generated accounts and routing/authz rules for S-1-5-112-0-0X20-0X0000000A -->


  <Macro Id="OOBE_ACCOUNT_ID" Value="S-1-5-112-0-0X10-0X0000000A" Description="oobe.exe account id"></Macro>

    <Rule Description="Grant access to MyPhone CSP" ResourceIri="/METABASE/./VENDOR/MSFT/MYPHONE/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
        <Authorize>
          <Match AccountId="$(OOBE_ACCOUNT_ID)" AuthorizationIds="METABASE_ALL"></Match>
        </Authorize>
    </Rule>
    
    <Rule Action="CreateNew" Description="Restricts the registry keys used for creating alarms" ResourceIri="$(HKCU)/SOFTWARE/MICROSOFT/CLOCK/(*)" SpeakerAccountId="$(SYSTEM_USER_NAME)" PriorityCategoryId="PRIORITY_HIGH">
        <Authorize>
          <Match AccountId="$(STANDARD_RIGHTS_RESOURCE_GROUP_NAME)" AuthorizationIds="KEY_ALL_ACCESS"></Match>
        </Authorize>
        <Stop>
          <Match AccountId="$(EVERYONE_GROUP_NAME)"></Match>
        </Stop>
    </Rule>

</CeSecurityPolicyFile>
